# 更新日志

## [2.0.1] - 2025-11-10

### 🐛 修复
- 修复 Markdown 中 `./assets/` 资源路径未被识别的问题，确保引用的资源正确扫描并上传至 NextCloud

### ✨ 新增
- 右键资源管理器支持直接上传 Excel (`.xlsx`) 文件
- 发布结果提示新增“打开目录”按钮，可快速进入 NextCloud 对应文件夹
- 新增 “Download From NextCloud To Local” 命令，支持从 NextCloud 将文件或目录同步到本地

### 🔧 改进
- 上传目录选择器自动预填当前文档/目录的相对路径（已移除工作区根目录）
- 创建分享链接时优先复用已有链接，避免重复生成

### 📦 其他
- 版本号更新至 2.0.1

## [2.0.0] - 2025-10-29

### 🎯 重大变更

#### 配置变更
- **WebDAV文件空间用户名改为必填** - `nextcloud.webdavUsername` 现在是必填配置项
- **删除 basePath 配置** - 不再需要配置 basePath，上传目录在发布时动态选择
- **删除 serviceName 配置** - 移除 `project.serviceName` 配置项

#### 新增功能
- **动态目录选择** - 发布时弹出对话框，支持输入新目录或选择历史记录
- **历史记录管理** - 自动保存最近使用的上传目录，最多保存20条
- **目录历史删除** - 在目录选择对话框中可以直接删除不需要的历史记录
- **智能目录输入** - 支持实时预览输入的新目录路径

### 📖 文档
- 更新 README，删除 basePath 和 serviceName 相关说明
- 更新配置示例，移除已删除的配置项
- 更新所有目录结构和路径说明
- 添加动态目录选择功能的使用说明

### 🔧 改进
- 简化配置流程，只需配置NextCloud连接信息
- 提升用户体验，上传目录完全由用户控制
- 优化目录选择界面，支持历史记录快速选择
- 改进错误提示，移除basePath相关的提示

### 破坏性变更
- **必须更新配置**：`nextcloud.webdavUsername` 现在是必填项
- **删除配置项**：`nextcloud.basePath` 和 `project.serviceName` 已移除
- **行为变更**：上传目录不再从配置读取，改为发布时动态选择
- **升级建议**：
  1. 更新配置，确保 `webdavUsername` 已填写（必填）
  2. 从配置文件中删除 `basePath` 和 `serviceName`
  3. 首次使用新版本时，需要在发布时输入上传目录

---

## [1.1.0] - 2025-10-16

### 🎯 新增
- **WebDAV 用户名配置** - 添加 `webdavUsername` 配置项，支持企业环境中不同的 WebDAV 用户名格式（如 `username_3074`）
- **增强测试连接** - 显示根目录文件列表和详细诊断信息
- **自动创建目录** - 自动检测并尝试创建 basePath 目录
- **故障排查指南** - 新增完整的故障排查文档
- **应用专用密码指南** - 新增详细的应用专用密码获取指南
- **文件覆盖策略** - 添加 `overwriteExisting` 配置，默认自动覆盖已存在的文件，避免手动选择版本

### 📖 文档
- 新增 [故障排查指南](docs/TROUBLESHOOTING.md)
- 新增 [应用专用密码指南](docs/APP_PASSWORD_GUIDE.md)
- 更新 [NextCloud 配置指南](docs/NEXTCLOUD_CONFIG.md)
- 更新所有配置示例和说明

### 🐛 修复
- 修复 WebDAV 认证用户名与文件空间用户名不一致的问题
- 修复资源扫描时重复警告的问题
- **修复文件上传时的版本选择问题** - 现在自动覆盖已存在的文件，避免 NextCloud 提示手动选择版本
- 自动处理 NextCloud URL 末尾的斜杠

### 🔧 改进
- 改进错误提示，提供更详细的解决建议
- 优化日志输出，使用不同级别区分信息
- 完善所有配置文档和示例

---

## [1.0.1] - 2025-10-16

### 🐛 修复
- **修复目录创建逻辑** - 不再尝试创建 basePath 及其父目录，避免 403/409 错误
- **basePath 改为必填项** - 必须指向 NextCloud 中已存在的根目录，无默认值
- **改进路径处理** - 支持 Windows 反斜杠，正确标准化路径

### 📖 文档
- 更新 `NEXTCLOUD_SETUP_GUIDE.md` - 包含完整配置说明和修复要点
- 更新配置示例和说明

### 🔧 改进
- 更清晰的配置错误提示
- 更完善的日志输出

### ⚠️ 破坏性变更
- basePath 从可选（默认 `/Docs`）变为必填项
- 使用前必须在 NextCloud 中手动创建 basePath 目录

## [1.0.0] - 2025-10-16

### 新增功能
- ✨ 支持单个文档发布到 NextCloud
- ✨ 支持批量目录发布到 NextCloud
- ✨ 自动上传 assets 目录下的资源文件
- ✨ 自动替换 Markdown 中的资源链接为 NextCloud 分享链接
- ✨ 支持通过 Cursor 设置或项目配置文件配置插件
- ✨ 支持环境变量配置
- ✨ 提供连接测试功能
- ✨ 提供配置查看功能
- ✨ 详细的日志输出
- ✨ 右键菜单快捷操作
- ✨ 键盘快捷键支持

### 技术特性
- 🔧 基于 TypeScript 开发
- 🔧 使用 WebDAV 协议上传文件
- 🔧 使用 NextCloud Sharing API 创建分享链接
- 🔧 支持递归创建目录
- 🔧 支持批量上传和链接创建
- 🔧 实时进度显示

### 文档
- 📚 完整的 README 使用文档
- 📚 详细的配置说明
- 📚 插件开发指南
- 📚 故障排查指南

